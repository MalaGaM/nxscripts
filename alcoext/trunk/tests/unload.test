#
# AlcoExt - Alcoholicz Tcl extension.
# Copyright (c) 2005-2006 Alcoholicz Scripting Team
#
# Module Name:
#   Unload Tests
#
# Author:
#   neoxed (neoxed@gmail.com) Mar 16, 2006
#
# Abstract:
#   Tests for Tcl 8.5's extension unloading support.
#

set currentPath [file dirname [file normalize [info script]]]
source [file join $currentPath "loader.tcl"]

testConstraint haveUnload [expr {[llength [info commands unload]] == 1}]

################################################################################
# unload                                                                       #
################################################################################

test unload-1.1 {unload: unload extension from interp} {haveUnload} {
    set interp [interp create]
    interp eval $interp [list load $libFile]
    interp eval $interp [list unload -keeplibrary -- $libFile]
    interp delete $interp
} {}

test unload-1.2 {unload: unload extension from process} {haveUnload} {
    set interp [interp create]
    interp eval $interp [list load $libFile]
    interp eval $interp [list unload -- $libFile]
    interp delete $interp
} {}


::tcltest::cleanupTests
return
