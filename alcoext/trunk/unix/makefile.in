#
# AlcoExt - Alcoholicz Tcl extension.
# Copyright (c) 2005 Alcoholicz Scripting Team
#
# File Name:
#   makefile.in
#
# Author:
#   neoxed (neoxed@gmail.com) June 17, 2005
#
# Abstract:
#   Makefile template.
#

#========================================================================
# Package Settings
#========================================================================

PACKAGE_NAME    = @PACKAGE_NAME@
PACKAGE_VERSION = @PACKAGE_VERSION@
PKG_LIB_FILE    = @PKG_LIB_FILE@
PKG_STUB_FILE   = @PKG_STUB_LIB_FILE@

PKG_SOURCES     = @PKG_SOURCES@
PKG_OBJECTS     = @PKG_OBJECTS@
PKG_STUB_SOURCES= @PKG_STUB_SOURCES@
PKG_STUB_OBJECTS= @PKG_STUB_OBJECTS@

#========================================================================
# Locations
#========================================================================

BUILD_DIR       = .
ROOT_DIR        = .
SHELL           = @SHELL@
BINARIES        = $(PKG_LIB_FILE)
CLEANFILES      = @CLEANFILES@

AR              = @AR@
CC              = @CC@
RANLIB          = @RANLIB@

#========================================================================
# Flags
#========================================================================

CFLAGS          = @CFLAGS@
CFLAGS_DEFAULT  = @CFLAGS_DEFAULT@
CFLAGS_WARNING  = @CFLAGS_WARNING@
CPPFLAGS        = @CPPFLAGS@
EXEEXT          = @EXEEXT@
OBJEXT          = @OBJEXT@

MAKE_LIB        = @MAKE_LIB@
MAKE_SHARED_LIB = @MAKE_SHARED_LIB@
MAKE_STATIC_LIB = @MAKE_STATIC_LIB@
MAKE_STUB_LIB   = @MAKE_STUB_LIB@
RANLIB_STUB     = @RANLIB_STUB@

LDFLAGS_DEFAULT = @LDFLAGS_DEFAULT@
SHLIB_CFLAGS    = @SHLIB_CFLAGS@
SHLIB_LD        = @SHLIB_LD@
SHLIB_LD_LIBS   = @SHLIB_LD_LIBS@
STLIB_LD        = @STLIB_LD@

TCL_BIN_DIR     = @TCL_BIN_DIR@
TCL_DEFS        = @TCL_DEFS@
TCL_LIBS        = @TCL_LIBS@
TCL_SRC_DIR     = @TCL_SRC_DIR@

#========================================================================
# TCLLIBPATH seeds the auto_path in Tcl's init.tcl so we can test our
# package without installing.  The other environment variables allow us
# to test against an uninstalled Tcl.  Add special env vars that you
# require for testing here (like TCLX_LIBRARY).
#========================================================================

EXTRA_PATH      = $(BUILD_DIR):$(TCL_BIN_DIR)
TCLLIBPATH      = $(BUILD_DIR)
TCLSH_ENV       = TCL_LIBRARY=`@CYGPATH@ $(TCL_SRC_DIR)/library` \
    @LD_LIBRARY_PATH_VAR@="$(EXTRA_PATH):$(@LD_LIBRARY_PATH_VAR@)" \
    PATH="$(EXTRA_PATH):$(PATH)" TCLLIBPATH="$(TCLLIBPATH)"

TCLSH_PROG      = @TCLSH_PROG@
TCLSH           = $(TCLSH_ENV) $(TCLSH_PROG)

DEFS            = -DLTC_NO_ROLC @DEFS@ @PKG_CFLAGS@
INCLUDES        = @PKG_INCLUDES@ @TCL_INCLUDES@
LIBS            = @PKG_LIBS@ @LIBS@
COMPILE         = $(CC) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)

#========================================================================
# Targets
#========================================================================

all: binaries libraries

binaries: $(BINARIES)

libraries: binaries

depend:

test: binaries libraries
	$(TCLSH) `@CYGPATH@ $(ROOT_DIR)/tests/all.tcl` $(TESTFLAGS)

$(PKG_LIB_FILE): $(PKG_OBJECTS)
	-rm -f $(PKG_LIB_FILE)
	${MAKE_LIB}
	$(RANLIB) $(PKG_LIB_FILE)

$(PKG_STUB_FILE): $(PKG_STUB_OBJECTS)
	-rm -f $(PKG_STUB_FILE)
	${MAKE_STUB_LIB}
	$(RANLIB_STUB) $(PKG_STUB_FILE)

VPATH = $(ROOT_DIR):\
    $(ROOT_DIR)/generic:\
    $(ROOT_DIR)/unix:\
    $(ROOT_DIR)/win:\
    $(ROOT_DIR)/libs/tomcrypt/ciphers:\
    $(ROOT_DIR)/libs/tomcrypt/ciphers/aes:\
    $(ROOT_DIR)/libs/tomcrypt/ciphers/safer:\
    $(ROOT_DIR)/libs/tomcrypt/ciphers/twofish:\
    $(ROOT_DIR)/libs/tomcrypt/hashes:\
    $(ROOT_DIR)/libs/tomcrypt/hashes/chc:\
    $(ROOT_DIR)/libs/tomcrypt/hashes/helper:\
    $(ROOT_DIR)/libs/tomcrypt/hashes/sha2:\
    $(ROOT_DIR)/libs/tomcrypt/hashes/whirl:\
    $(ROOT_DIR)/libs/tomcrypt/hmac:\
    $(ROOT_DIR)/libs/tomcrypt/misc:\
    $(ROOT_DIR)/libs/tomcrypt/misc/base64:\
    $(ROOT_DIR)/libs/tomcrypt/misc/crypt:\
    $(ROOT_DIR)/libs/tomcrypt/misc/pkcs5:\
    $(ROOT_DIR)/libs/tomcrypt/modes/cbc:\
    $(ROOT_DIR)/libs/tomcrypt/modes/cfb:\
    $(ROOT_DIR)/libs/tomcrypt/modes/ctr:\
    $(ROOT_DIR)/libs/tomcrypt/modes/ecb:\
    $(ROOT_DIR)/libs/tomcrypt/modes/ofb:\
    $(ROOT_DIR)/libs/tomcrypt/prngs:\
    $(ROOT_DIR)/libs/zlib/source

.c.@OBJEXT@:
	$(COMPILE) -c `@CYGPATH@ $<` -o $@

#========================================================================
# Don't modify the file to clean here.  Instead, set the "CLEANFILES"
# variable in configure.in
#========================================================================

clean:
	-test -z "$(BINARIES)" || rm -f $(BINARIES)
	-rm -f *.$(OBJEXT) core *.core
	-test -z "$(CLEANFILES)" || rm -f $(CLEANFILES)

distclean: clean
	-rm -f config.cache config.log config.status Makefile
	-rm -rf autom4te.cache

.PHONY: all binaries clean depend distclean libraries test

# Tell versions [3.59,3.63) of GNU make to not export all variables.
# Otherwise a system limit (for SysV at least) may be exceeded.
.NOEXPORT:
